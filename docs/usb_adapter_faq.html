<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arduino Sim Racing Library: USB Adapter FAQ</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="gear_shift_logo.svg" type="image/svg+xml" rel="shortcut icon" />
<link href="sim-racing-docs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">DoxygenAwesomeDarkModeToggle.init()</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="gear_shift_logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">Arduino Sim Racing Library<span id="projectnumber">&#160;v2.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('usb_adapter_faq.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">USB Adapter FAQ</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_pages_2usb__adapter__faq"></a> This page constains answers to frequently asked questions (FAQ) about building USB adapters using the <a href="https://github.com/dmadison/Sim-Racing-Arduino">Sim Racing Library for Arduino</a>.</p>
<p>You can find my tutorial videos for building your own USB adapters <a href="https://www.youtube.com/playlist?list=PLTboGmshZ5EIWQSYEjdrIFqgc2J6sLCSa">on YouTube</a>.</p>
<h2><a class="anchor" id="autotoc_md29"></a>
I have a G923 / G920 / G29 shifter. Why do you call it the "Driving Force" shifter?</h2>
<p><a href="https://www.logitechg.com/en-us/products/driving/driving-force-shifter.html">That's what Logitech calls it</a>.</p>
<h2><a class="anchor" id="autotoc_md30"></a>
What shifters are compatible with these DIY USB adapters?</h2>
<p>I have made DIY USB adapter tutorial videos for the <a class="el" href="logitech_shifter.html">Logitech Driving Force shifter</a>, the <a class="el" href="logitech_shifter_g27.html">Logitech G27 shifter</a>, and the <a class="el" href="logitech_shifter_g25.html">Logitech G25 shifter</a>.</p>
<p>All of these adapters are <b>only</b> compatible with the advertised shifter (i.e. if you made an adapter for the G25, it's only compatible with the G25). The exception to this is the G27 adapter, which is forwards-compatible with the Driving Force shifter. Do not connect an incompatible shifter to your adapter, you may damage the shifter or the Arduino!</p>
<h2><a class="anchor" id="autotoc_md31"></a>
Can I make an adapter that supports all three shifters?</h2>
<p>Yes, but it requires some additional resistors. The <a href="https://github.com/dmadison/Sim-Racing-Shields/">Sim Racing Shifter Shield</a> I designed supports all three shifters, as does its included firmware. Take a look at the schematic for reference.</p>
<h2><a class="anchor" id="autotoc_md32"></a>
Why is the power LED off for my G25 / G27 adapter? How do I turn it on?</h2>
<p>The power LED is controlled separately, and isn't required for the adapter to function (which is why it's not included in the tutorial video).</p>
<p>The control pin for the power LED is DE-9 pin 5. If you connect that pin to ground (GND) on the Arduino, the LED will always be on. If you connect that pin to one of the Arduino's I/O pins and pass the pin number to the shifter object's constructor, you can control its state using the <code><a class="el" href="class_sim_racing_1_1_logitech_shifter_g27.html#afa0259caffab594650ab419b2eccf4c3" title="Sets the state of the shifter&#39;s power LED.">SimRacing::LogitechShifterG27::setPowerLED(bool)</a></code> function.</p>
<p>On the G25, I would recommend adding a 100 Ohm resistor in series so that the power and sequential mode LEDs are similar in brightness. You can add a series resistor on either shifter to reduce the brightness of the LED.</p>
<h2><a class="anchor" id="autotoc_md33"></a>
Can I make a USB adapter with both a shifter and pedals?</h2>
<p>Yes! Although you'll need to get your hands a little dirty with the code.</p>
<p>You'll need to change the wiring to the Arduino board so that you can fit both peripherals. None of the devices are particularly picky about which pins you use, so there's a lot of flexibility there. The only restrictions are that the power pins (5V/GND) need to stay the same, and the analog outputs need to connect to the analog pins (A0-A5). I would recommend changing the pins on the existing examples and testing them out before continuing further.</p>
<p>You will also need to combine the two example codes together. Believe me, this is easier than it sounds. I'd recommend opening two code windows side-by-side and copying between them. Add the new lines, remove duplicate lines, and if two lines are different do your best to reason out why that is. The most complicated bit is the <code>Joystick</code> object definition, which needs to change based on what you're outputting to USB. Hopefully the comments (the <code>//</code> bits) are clear enough.</p>
<p>The library itself does not need to be modified, only the example code. If you run into any trouble there are a number of great learning resources online, including <a href="https://forum.arduino.cc/">the Arduino forums</a> and <a href="https://www.reddit.com/r/arduino">the Arduino subreddit</a>. Good luck!</p>
<h2><a class="anchor" id="autotoc_md34"></a>
Can I use an Arduino Uno / Arduino Nano / Arduino Mega instead of an Arduino Leonardo?</h2>
<p>Short answer: <b>No</b>.</p>
<p>Long answer: <em>Maybe</em>. But it requires a specific variant of the board and it's significantly more effort.</p>
<p>The tutorials suggest using an <a href="https://docs.arduino.cc/hardware/leonardo/">Arduino Leonardo</a> because the onboard microcontroller (the ATmega32U4) has a hardware USB controller and female headers that don't require soldering. This means that the library code can set the USB descriptors and tell the microcontroller to behave as a USB human interface device (HID), then control the output based on the sim racing peripheral.</p>
<p>In contrast, the microcontrollers on the <a href="https://docs.arduino.cc/hardware/uno-rev3/">Arduino Uno (ATmega328P)</a>, <a href="https://docs.arduino.cc/hardware/nano/">Arduino Nano (ATmega328P)</a>, and <a href="https://docs.arduino.cc/hardware/mega-2560/">Arduino Mega (ATmega2560)</a> do <b>not</b> have a USB controller. Instead, they use a secondary integrated circuit (IC) to convert the serial data (UART) into USB. This means that the library code <em>cannot</em> set the USB descriptors to tell the microcontroller to behave as a USB HID device.</p>
<p>On the Arduino Nano and on most low cost clones of the Arduino Uno and Arduino Mega, that IC is the <a href="https://ftdichip.com/products/ft232rl/">FT232</a> or a knockoff like the CH340. These chips are unable to act as a USB adapter.</p>
<p>On genuine and more expensive Arduino Unos and Arduino Megas, that IC is the ATmega16U2 - another microcontroller, and the brother of the ATmega32U4 onboard the Leonardo. With these boards it <em>is</em> technically possible to use them as a USB adapter, although it's not easy.</p>
<p>To convert the ATmega16U2 into an HID device you can install the <a href="https://github.com/AlanChatham/UnoJoy">UnoJoy</a> firmware. This is tricky to do over USB (using "Device Firmware Update" / DFU mode), but can be simplified using a hardware ICSP programmer. There are further instructions in that repository's documentation.</p>
<p>You will also need to modify the library examples to use the UnoJoy library in place of the Joystick library to send serial commands to the ATmega16U2. This should be relatively straightforward, but you will need to understand some basic C/C++ programming.</p>
<p>To recap, the process is: </p><pre class="fragment">1. Inspect the board to verify that you have a compatible model (Arduino Uno or Arduino Mega with an ATmega16U2 as the USB to serial interface)
2. Reset the ATmega16U2 into DFU mode by shorting the reset pins on the ICSP header (or) attach an external hardware programmer
3. Flash UnoJoy firmware to the ATmega16U2
4. Rewrite the library examples to use the UnoJoy library in place of the Joystick library for USB output
5. Upload the code to the Uno (ATmega328P)
</pre><p> Fair warning that you may have some difficulty getting the ATmega16U2 into DFU mode, and you may have some difficulty getting it back to functioning as a "regular" Arduino board afterwards. It is also possible to "brick" the board and render it in an unusable state. This is often recoverable but requires a hardware ICSP programmer.</p>
<h2><a class="anchor" id="autotoc_md35"></a>
Can I use ______ microcontroller instead?</h2>
<p>Maybe! The library itself should be compatible with most development boards that support the Arduino framework. Try to compile one of the library examples for your microcontroller. If it compiles, it will probably work!</p>
<p>The <a href="https://github.com/MHeironimus/ArduinoJoystickLibrary/">Joystick library</a> supports a more limited subset of boards, and you may need to rewrite the Sim Racing Library example code to use a different USB library.</p>
<h2><a class="anchor" id="autotoc_md36"></a>
The Arduino Leonardo is really big. Is there a smaller board I can use?</h2>
<p>Yes! The <a href="https://www.sparkfun.com/sparkfun-qwiic-pro-micro-usb-c-atmega32u4.html">SparkFun Pro Micro (ATmega32U4)</a> has the same microcontroller and the same pinout. It's also the microcontroller that's compatible with the <a href="https://github.com/dmadison/Sim-Racing-Shields/">Sim Racing Shields</a>. But because it doesn't have female headers, you must solder to the pins.</p>
<h2><a class="anchor" id="autotoc_md37"></a>
The SparkFun Pro Micro doesn't have a 5V pin. Which pin should I use?</h2>
<p>You should use the VCC pin for power in place of the 5V pin.</p>
<h2><a class="anchor" id="autotoc_md38"></a>
I don't know how to solder. How do I connect multiple wires to one pin?</h2>
<p>I would recommend using <a href="https://www.wago.com/us/f/222-series-lever-nuts">Wago 221 Series</a> or <a href="https://www.wago.com/us/f/221-series-levernuts">Wago 222 Series Lever-Nuts</a>. You can find them at many hardware stores, they're easy to use and make a solid connection.</p>
<p>You can also use a more traditional solderless breadboard. These are common prototyping tools, but they aren't a great long term solution as the wires can come loose.</p>
<h2><a class="anchor" id="autotoc_md39"></a>
Why can't I just use a DE-9 to USB adapter?</h2>
<p>The <a href="https://en.wikipedia.org/wiki/D-subminiature">DE-9 connector</a> (also commonly called the "DB9" connector) has historically been used for serial devices using the <a href="https://en.wikipedia.org/wiki/RS-232">RS-232 standard</a>. Most common "DE-9 to USB" adapters you will find are, in fact, RS-232 to USB adapters.</p>
<p>Although they use the DE-9 connector, none of the Logitech sim racing peripherals in this library are RS-232 devices. At best, the adapter will not work. At worst, you may damage the adapter or your sim racing peripheral. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
<!-- ... -->
</body>
</html>
